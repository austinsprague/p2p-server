{"version":3,"names":[],"mappings":"","sources":["campaign-detail/controllers/campaign-detail-controller.js"],"sourcesContent":["(function () {\n  'use strict';\n\n  /**\n   * @ngdoc object\n   * @name campaignDetail.controller:CampaignDetailCtrl\n   *\n   * @description\n   *\n   */\n  angular\n    .module('campaignDetail')\n    .controller('CampaignDetailCtrl', CampaignDetailCtrl);\n\n  function CampaignDetailCtrl($state, $stateParams, CampaignDetailService, $http, $cookies) {\n    var vm = this;\n    vm.ended = false;\n    vm.funded = false;\n    vm.currentUserId = $cookies.getObject('user') || 1;\n    vm.campaignId = $stateParams.id;\n\n    CampaignDetailService.getProjectsById(vm.campaignId).then(function(data) {\n      vm.projectById = data;\n      console.log(vm.projectById);\n      vm.campaignUserId = data.user_id;\n      vm.company_name = data.company_name;\n      vm.img_url = data.img_url;\n      vm.category = data.category;\n      vm.neighborhood = data.neighborhood;\n      vm.status = data.status;\n      vm.info = [];\n      angular.forEach(data, function(value, key) {\n        var titles = ['pitch', 'targ_mkt','uniq_comp', 'history', 'use_of_funds']\n        if (value && titles.includes(key)) {\n          var obj = {\n            title: key.replace(/_/g, \" \"),\n            details: value\n          }\n          this.push(obj);\n        }\n      }, vm.info);\n    });\n    CampaignDetailService.getBackedInfo(vm.campaignId).then(function(data){\n      vm.backerCount = data.length;\n      vm.amtPledged = 0;\n      for (var i = 0; i < data.length; i++) {\n        vm.amtPledged += data[i].amt_pledged;\n      }\n    })\n\n    vm.createUserCharge = function(amount){\n      vm.userCharge = {};\n      vm.userCharge.backer_id = vm.currentUserId;\n      vm.userCharge.proj_id = vm.campaignId;\n      vm.userCharge.amount = amount;\n      vm.userCharge.user_id = vm.campaignUserId;\n      console.log('this is charge object' , vm.userCharge);\n\n\n      $http.post('/api/user_projects/charge/' + vm.campaignId, vm.userCharge)\n      .then(function(user){\n        console.log('this is user', user);\n        // vm.amtPledged = vm.amtPledged + parseInt(user.data.amount);\n        // vm.backerCount = vm.backerCount + 1;\n        $state.go('profile');\n        // return user;\n      })\n    }\n  }\n}());\n"],"file":"campaign-detail/controllers/campaign-detail-controller.js","sourceRoot":"/source/"}